var n={SNL_COUNT:10,ANIMATION_SPEED:100,MAX_RANDOM_MOVE_LIMIT:20,chutes:[],ladders:[],cells:[],playerToRoll:0,multiplePlayerCellStyle:"font-size: 10px;line-height: inherit;background:wheat",players:[],moveCount:0,gameLog:null,rollButton:null,winMessage:null,colors:["#89cff0","#ff8c00","#f4c2c2","#fae7b5","#f4bbff","#a3c1ad"],init:function(numberOfPlayers){for(n.winMessage=document.getElementById("winMessage"),n.gameLog=document.getElementById("gameLog"),n.rollButton=document.getElementById("roll"),n.cells[0]="",i=1;i<=100;i++)n.cells.push(document.getElementById(i));for(i=0;i<n.SNL_COUNT;i++)n.chutes.push(Math.ceil(97*Math.random())+2),n.ladders.push(Math.ceil(97*Math.random())+2);for(i=0;i<n.SNL_COUNT;i++)n.cells[n.chutes[i]].classList+=" snk",n.cells[n.ladders[i]].classList+=" ldr";for(looper=0;looper<numberOfPlayers;looper++)n.players.push(n.getPlayer(looper+"",n.colors[looper]));for(looper=0;looper<n.players.length;looper++)n.moveTo(looper,1),n.addToCell(1,looper);n.rollButton.innerHTML="Roll P"+n.playerToRoll},autoPlay:function(){setInterval(function(){n.rollButton.click()},n.ANIMATION_SPEED)},win:function(playerId){n.rollButton.disabled=!0,n.winMessage.innerHTML="P"+playerId+" won!<br> Refresh page to restart",console.log("Total moves: "+n.moveCount),n.winMessage.style="display:block"},addToLog:function(text){n.gameLog.innerHTML+="<br>"+text},getPlayer:function(pid,pcolor){return{id:pid,color:pcolor,pos:1}},moveTo:function(playerId,cell){if(n.players[playerId].pos<cell)var direction=1;else{if(!(n.players[playerId].pos>cell))return void(n.rollButton.disabled=!1);var direction=-1}n.rollButton.disabled=!0;var intrvl=setInterval(function(){return playerPosition=n.players[playerId].pos,1==playerPosition&&direction==-1?(n.rollButton.disabled=!1,void clearInterval(intrvl)):100==playerPosition&&1==direction?(n.rollButton.disabled=!1,n.win(playerId),void clearInterval(intrvl)):playerPosition==cell?(n.checkCells(playerId,playerPosition),void clearInterval(intrvl)):(n.deleteFromCell(playerPosition,playerId),n.addToCell(playerPosition+direction,playerId),playerPosition+=direction,void(n.players[playerId].pos=playerPosition))},n.ANIMATION_SPEED)},addToCell:function(cellId,playerId){cellId<1||cellId>100||("undefined"==typeof n.cells[cellId].playersInCell&&(n.cells[cellId].playersInCell=[]),n.cells[cellId].playersInCell.push(n.players[playerId].id),n.cells[cellId].playersInCell.length>1?n.cells[cellId].style=n.multiplePlayerCellStyle:n.cells[cellId].style="background:"+n.players[playerId].color,n.updateCell(cellId))},deleteFromCell:function(cellId,playerId){cellId<1||cellId>100||"undefined"!=typeof n.cells[cellId].playersInCell&&(n.cells[cellId].playersInCell.splice(n.cells[cellId].playersInCell.indexOf(n.players[playerId].id),1),1==n.cells[cellId].playersInCell.length?n.cells[cellId].style="background:"+n.players[n.cells[cellId].playersInCell[0]].color:n.cells[cellId].playersInCell.length>1?n.cells[cellId].style=n.multiplePlayerCellStyle:n.cells[cellId].style="",n.updateCell(cellId))},updateCell:function(cellId){"undefined"==typeof n.cells[cellId].playersInCell?n.cells[cellId].innerHTML=n.cells[cellId].id:n.cells[cellId].playersInCell.length>0?n.cells[cellId].innerHTML="P"+n.cells[cellId].playersInCell.join():n.cells[cellId].innerHTML=n.cells[cellId].id},checkCells:function(playerId,cell){n.ladders.indexOf(cell)!=-1?(n.addToLog("P"+n.playerToRoll+" hit a ladder at "+cell+" !"),n.addToLog("Moving.."),n.moveTo(playerId,cell+(Math.floor(Math.random()*n.MAX_RANDOM_MOVE_LIMIT)+1))):n.chutes.indexOf(cell)!=-1?(n.addToLog("P"+n.playerToRoll+" hit a chute at "+cell+" !"),n.addToLog("Moving.."),n.moveTo(playerId,cell-(Math.floor(Math.random()*n.MAX_RANDOM_MOVE_LIMIT)+1))):(n.rollButton.disabled=!1,n.players[playerId].pos=cell)},rollDice:function(){n.moveCount+=1,n.rollButton.disabled=!0,n.gameLog.innerHTML="";var rolled=Math.ceil(6*Math.random());n.addToLog("P"+n.playerToRoll+" rolled: "+rolled+" !"),n.addToLog("Moving.."),n.moveTo(n.playerToRoll,n.players[n.playerToRoll].pos+rolled),n.playerToRoll=(n.playerToRoll+1)%n.players.length,n.rollButton.innerHTML="Roll P"+n.playerToRoll}};document.getElementById("startButton").addEventListener("click",function(){var numberOfPlayers=parseInt(document.getElementById("numberOfPlayers").value);"number"!=typeof numberOfPlayers&&(numberOfPlayers=2),n.init(document.getElementById("numberOfPlayers").value),document.getElementById("startingSettings").style="display:none;",document.getElementById("gameArea").style=""});
