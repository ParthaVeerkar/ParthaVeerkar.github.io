<!doctype html>
<html>
<head>
   <title>Cellular Automaton</title>
<style>
*{text-align:center;vertical-align:top;margin:auto}body{padding-top:30px;width:800px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cell{color:grey;padding:0;margin:0;text-align:center;vertical-align:center;cursor:pointer}.activeCell{background:#000}.menuElement{margin:5px 0 5px 5px;text-align:right;vertical-align:middle}.buttons{padding:5px;cursor:pointer;width:50px;font-weight:700;margin-top:10px;display:inline-block;text-align:center;background-color:#eee;background-image:-webkit-linear-gradient(#fcfcfc,#eee);background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #C2C2C2;border-radius:3px}.buttons:hover{background-color:silver;background-image:-webkit-linear-gradient(#eee,silver);background-image:linear-gradient(#eee,silver)}#tab{border:1px solid grey;display:inline-block;position:absolute;top:20px;left:290px}.inputBox{width:50px}#menu{display:inline-block;text-align:right;position:absolute;top:20px;left:30px}#infoDiv{display:none;text-align:left;position:absolute;top:27px;line-height:27px;left:300px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;background-color:#fff}#infoDiv a{text-decoration:none;font-weight:700;color:#0b0b91}.helpBtn{border:2px solid #000;border-radius:10px;padding:3px 7px}#buttonsHelp{text-align:left;line-height:40px}#gridHeightPointer{color:red}.settingPointer{color:#ca1111;font-weight:700}.note{font-weight:700}#infoDiv ol li{text-align:left}#helpButton{width:184px;font-size:21px;font-weight:700}.tryThis{font-size:20px;line-height:50px}
</style>
</head>
<body>
<div id="menu">

<div id="settingsDiv" class="menuElement">
	<div class="menuElement">
	Threshold:
	<select id="thresholdValue" class="menuElement inputBox">
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3" selected>3</option>
		<option value="4">4</option>
		<option value="5">5</option>
		<option value="6">6</option>
		<option value="7">7</option>
		<option value="8">8</option>
		<option value="9">9</option>
	</select></div>
	<div class="menuElement">Delay (miliseconds): <input class="inputBox menuElement" id="intervalDelay" type="number" value="100"/><br><span class="help">(delay between state transition)</span></div>
	<div class="menuElement">Grid Wdith: <input class="inputBox menuElement" id="gridWidth" type="number" value="40"/><br><span class="help">(number of cells in a rows)</span></div>
	<div class="menuElement">Grid Height: <input class="inputBox menuElement" id="gridHeight" type="number" value="40"/><br><span class="help">(number of rows)</span></div>
	<div class="menuElement">Cell size (px): <input class="inputBox menuElement" id="cellSize" type="number" value="10"/><br><span class="help">(length of side of each cell)</span></div>
	<div id="resetButton" class="menuElement buttons">Reset</div>
	<div id="stepButton" class="menuElement buttons">Step</div>

<div id="onOffButton" class="menuElement buttons">Start</div></div><br>
<div id="helpButton" class="menuElement buttons">What is this?<br><font size="4px">(help)</font></div>
</div>
<table id="tab" cellspacing="0px">
</table>
<div id="infoDiv">
This here is simple <a href="http://en.wikipedia.org/wiki/Cellular_automaton">Cellular Automaton</a>.<br><br>
The square box is grid containing <span class="settingPointer">Grid Height</span> x <span class="settingPointer">Grid Wdith</span> number of cells.<br>
Each cell in the grid can have 2 states (on or off).<br>
(You can turn cells ON or OFF by clicknig inside the grid)<br>
At any instance, each cell updates itself depending on the state of its <a href="http://en.wikipedia.org/wiki/Moore_neighborhood">neighbors</a>.<br>
A cell will change its state if more than <span class="settingPointer">threshold</span> number of its neighbors are in the 'on' state. <br><br>
<div id="buttonsHelp">
<span class="helpBtn">Step</span> : All cells will update themselves once.<br>
<span class="helpBtn">Start</span> : Cells keep updating with at interval of <span class="settingPointer">Delay</span> seconds.<br>
<span class="helpBtn">Reset</span> : Resets the whole thing with the newly selected settings.
</div>
<br>
<span class="note">Note</span> : All the properties mentioned above in <span class="settingPointer">Red</span> can be changed in the menu to the left.
<br><br>
<font size="5px" class="settingPointer tryThis">Try these :</font> 
<br><ol>
	<li>Turn a few cells ON by clicking inside the box. Try drawing a 'Y' shape.</li>
	<li>Press start to let it begin</li>
</ol>
<br><ol>
	<li>Change threshold to 1</li>
	<li>Press start</li>
	<li>Click inside the box to turn any one cell ON</li>
	<li>Press stop</li>
	<li>Change threshold to 3</li>
	<li>Press start again</li>
</ol>
<br><ol>
	<li>Change the different parameter and try your own!</li>
</ol>
<br><br><br>
</div>
</body>
 <script type="text/javascript">
var cla={currentFrame:[],nextframe:[],drawingFlag:0,THRESHOLD:4,GRIDHEIGHT:30,GRIDWIDTH:30,settingsDiv:null,interval:null,INTERVALDELAY:0,screen:[],init:function(){cla.drawGrid(),cla.settingsDiv=document.getElementById("settingsDiv");var e=document.getElementById("tab"),t=document.getElementById("infoDiv");document.getElementById("helpButton").addEventListener("click",function(a){"block"==t.style.display?(t.style.display="none",e.style.display="block",a.target.innerHTML='What is this?<br><font size="4px">(help)</font>'):(t.style.display="block",e.style.display="none",a.target.innerHTML="Hide help")}),document.getElementById("resetButton").addEventListener("click",function(){cla.reset()},!1),document.getElementById("onOffButton").addEventListener("click",function(e){null==cla.interval?(cla.setConfig(),console.log(cla.THRESHOLD),cla.interval=setInterval(function(){cla.drawingFlag||(cla.drawingFlag=1,cla.createNewList(),cla.drawingFlag=0)},cla.INTERVALDELAY),e.target.innerHTML="Stop"):(clearInterval(cla.interval),cla.interval=null,e.target.innerHTML="Start")},!1),document.getElementById("stepButton").addEventListener("click",function(){null==cla.interval&&(cla.setConfig(),cla.drawingFlag||(cla.drawingFlag=1,cla.createNewList(),cla.drawingFlag=0))},!1)},setConfig:function(){var e=parseInt(document.getElementById("intervalDelay").value),t=parseInt(document.getElementById("thresholdValue").value);cla.INTERVALDELAY=Number.isInteger(e)?e:30,cla.THRESHOLD=Number.isInteger(t)?t:3,console.log(cla.THRESHOLD)},reset:function(){null!=cla.interval&&(clearInterval(cla.interval),cla.interval=null,document.getElementById("onOffButton").innerHTML="Start"),cla.setConfig(),cla.currentFrame=[],cla.nextFrame=[],cla.screen=[],document.getElementById("tab").innerHTML="",cla.drawGrid()},drawGrid:function(){var e=parseInt(document.getElementById("gridWidth").value),t=parseInt(document.getElementById("gridHeight").value),a=parseInt(document.getElementById("cellSize").value),n=document.getElementById("tab"),l=0,r=0;for(a=Number.isInteger(a)?a:15,cla.GRIDWIDTH=Number.isInteger(e)?e:30,cla.GRIDHEIGHT=Number.isInteger(t)?t:30,cla.screen[0]=null,l=cla.GRIDHEIGHT-1;l>=0;l--){var c=document.createElement("tr");for(c.setAttribute("id","r"+(l+1)),r=1;r<cla.GRIDWIDTH+1;r++){var i=document.createElement("td");i.setAttribute("id",l*cla.GRIDWIDTH+r),i.classList.add("cell"),i.setAttribute("width",a+"px"),i.setAttribute("height",a+"px"),i.setAttribute("active","false"),i.addEventListener("mouseup",function(e){cla.onOff(e.target.id)},!1),c.appendChild(i),cla.screen[i.id]=i}n.appendChild(c)}n.width=a*cla.GRIDWIDTH+"px"},clearAll:function(){var e=0;for(e=0;e<cla.currentFrame.length;e++)cla.onOff(cla.currentFrame[e])},onOff:function(e){var t=cla.screen[parseInt(e)];"true"==t.getAttribute("active")?(t.setAttribute("active","false"),cla.currentFrame.splice(cla.currentFrame.indexOf(parseInt(e)),1),t.classList.remove("activeCell")):(t.setAttribute("active","true"),-1==cla.currentFrame.indexOf(e)&&cla.currentFrame.push(parseInt(e)),t.classList.add("activeCell"))},createNewList:function(){var e,t,a,n,l=[],r=[];for(cla.nextFrame=[],e=0;e<=cla.currentFrame.length-1;e++)r.push(cla.currentFrame[e]),r=r.concat(cla.getNeighbors(cla.currentFrame[e]));for(r=cla.getUnique(r),e=0;e<r.length;e++){for(a=cla.getNeighbors(r[e]),n=0,t=0;t<a.length;t++)"true"==cla.screen[a[t]].getAttribute("active")&&n++;n>=cla.THRESHOLD?cla.nextFrame.push(r[e]):"true"==cla.screen[r[e]].getAttribute("active")&&l.push(r[e])}var c=0;for(e=0;e<cla.nextFrame.length;e++)c=cla.nextFrame[e],cla.onOff(c);cla.currentFrame=cla.getUnique(cla.currentFrame),cla.nextFrame=[]},getUnique:function(e){var t,a=[];for(t=0;t<e.length;t++)-1==a.indexOf(e[t])&&a.push(e[t]);return a},getNeighbors:function(e){var t=parseInt(e+""),a=[],n=t>cla.GRIDWIDTH?1:0,l=t<cla.GRIDWIDTH*(cla.GRIDHEIGHT-1)+1?1:0,r=(t-1)%cla.GRIDWIDTH?1:0,c=t%cla.GRIDWIDTH?1:0;return l&&(r&&a.push(t+cla.GRIDWIDTH-1),a.push(t+cla.GRIDWIDTH),c&&a.push(t+cla.GRIDWIDTH+1)),r&&a.push(t-1),c&&a.push(t+1),n&&(r&&a.push(t-cla.GRIDWIDTH-1),a.push(t-cla.GRIDWIDTH),c&&a.push(t-cla.GRIDWIDTH+1)),a}};window.onload=cla.init();</script>
</html>
