var cla={currentFrame:[],nextframe:[],drawingFlag:0,THRESHOLD:4,GRIDHEIGHT:30,GRIDWIDTH:30,settingsDiv:null,interval:null,INTERVALDELAY:0,screen:[],init:function(){cla.drawGrid(),cla.settingsDiv=document.getElementById("settingsDiv");var e=document.getElementById("tab"),t=document.getElementById("infoDiv");document.getElementById("helpButton").addEventListener("click",function(a){"block"==t.style.display?(t.style.display="none",e.style.display="block",a.target.innerHTML='What is this?<br><font size="4px">(help)</font>'):(t.style.display="block",e.style.display="none",a.target.innerHTML="Hide help")}),document.getElementById("resetButton").addEventListener("click",function(){cla.reset()},!1),document.getElementById("onOffButton").addEventListener("click",function(e){null==cla.interval?(cla.setConfig(),console.log(cla.THRESHOLD),cla.interval=setInterval(function(){cla.drawingFlag||(cla.drawingFlag=1,cla.createNewList(),cla.drawingFlag=0)},cla.INTERVALDELAY),e.target.innerHTML="Stop"):(clearInterval(cla.interval),cla.interval=null,e.target.innerHTML="Start")},!1),document.getElementById("stepButton").addEventListener("click",function(){null==cla.interval&&(cla.setConfig(),cla.drawingFlag||(cla.drawingFlag=1,cla.createNewList(),cla.drawingFlag=0))},!1)},setConfig:function(){var e=parseInt(document.getElementById("intervalDelay").value),t=parseInt(document.getElementById("thresholdValue").value);cla.INTERVALDELAY=Number.isInteger(e)?e:30,cla.THRESHOLD=Number.isInteger(t)?t:3,console.log(cla.THRESHOLD)},reset:function(){null!=cla.interval&&(clearInterval(cla.interval),cla.interval=null,document.getElementById("onOffButton").innerHTML="Start"),cla.setConfig(),cla.currentFrame=[],cla.nextFrame=[],cla.screen=[],document.getElementById("tab").innerHTML="",cla.drawGrid()},drawGrid:function(){var e=parseInt(document.getElementById("gridWidth").value),t=parseInt(document.getElementById("gridHeight").value),a=parseInt(document.getElementById("cellSize").value),n=document.getElementById("tab"),l=0,r=0;for(a=Number.isInteger(a)?a:15,cla.GRIDWIDTH=Number.isInteger(e)?e:30,cla.GRIDHEIGHT=Number.isInteger(t)?t:30,cla.screen[0]=null,l=cla.GRIDHEIGHT-1;l>=0;l--){var c=document.createElement("tr");for(c.setAttribute("id","r"+(l+1)),r=1;r<cla.GRIDWIDTH+1;r++){var i=document.createElement("td");i.setAttribute("id",l*cla.GRIDWIDTH+r),i.classList.add("cell"),i.setAttribute("width",a+"px"),i.setAttribute("height",a+"px"),i.setAttribute("active","false"),i.addEventListener("mouseup",function(e){cla.onOff(e.target.id)},!1),c.appendChild(i),cla.screen[i.id]=i}n.appendChild(c)}n.width=a*cla.GRIDWIDTH+"px"},clearAll:function(){var e=0;for(e=0;e<cla.currentFrame.length;e++)cla.onOff(cla.currentFrame[e])},onOff:function(e){var t=cla.screen[parseInt(e)];"true"==t.getAttribute("active")?(t.setAttribute("active","false"),cla.currentFrame.splice(cla.currentFrame.indexOf(parseInt(e)),1),t.classList.remove("activeCell")):(t.setAttribute("active","true"),-1==cla.currentFrame.indexOf(e)&&cla.currentFrame.push(parseInt(e)),t.classList.add("activeCell"))},createNewList:function(){var e,t,a,n,l=[],r=[];for(cla.nextFrame=[],e=0;e<=cla.currentFrame.length-1;e++)r.push(cla.currentFrame[e]),r=r.concat(cla.getNeighbors(cla.currentFrame[e]));for(r=cla.getUnique(r),e=0;e<r.length;e++){for(a=cla.getNeighbors(r[e]),n=0,t=0;t<a.length;t++)"true"==cla.screen[a[t]].getAttribute("active")&&n++;n>=cla.THRESHOLD?cla.nextFrame.push(r[e]):"true"==cla.screen[r[e]].getAttribute("active")&&l.push(r[e])}var c=0;for(e=0;e<cla.nextFrame.length;e++)c=cla.nextFrame[e],cla.onOff(c);cla.currentFrame=cla.getUnique(cla.currentFrame),cla.nextFrame=[]},getUnique:function(e){var t,a=[];for(t=0;t<e.length;t++)-1==a.indexOf(e[t])&&a.push(e[t]);return a},getNeighbors:function(e){var t=parseInt(e+""),a=[],n=t>cla.GRIDWIDTH?1:0,l=t<cla.GRIDWIDTH*(cla.GRIDHEIGHT-1)+1?1:0,r=(t-1)%cla.GRIDWIDTH?1:0,c=t%cla.GRIDWIDTH?1:0;return l&&(r&&a.push(t+cla.GRIDWIDTH-1),a.push(t+cla.GRIDWIDTH),c&&a.push(t+cla.GRIDWIDTH+1)),r&&a.push(t-1),c&&a.push(t+1),n&&(r&&a.push(t-cla.GRIDWIDTH-1),a.push(t-cla.GRIDWIDTH),c&&a.push(t-cla.GRIDWIDTH+1)),a}};window.onload=cla.init();
